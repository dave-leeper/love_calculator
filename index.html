<!DOCTYPE html>
<html>
<head>
<title>Love Calculator</title>
<script>
    class LoveNumber {
        static convertIntToLoveNumber(number){
            let flag = 0x1
            let loveNumber = new LoveNumber()
            let intNumber = Math.round(number)
            let isNegative = (0 > intNumber)

            intNumber = Math.abs(intNumber)
            for (let loop = 1; loop < 32; loop++) {
                if ((intNumber & flag ) !== 0) { 
                    if (!isNegative) {
                        loveNumber.positiveFlags[32 - loop] = "1"
                        loveNumber.positiveCounts[32 - loop] = 1
                    } else {
                        loveNumber.negativeFlags[32 - loop] = "1"
                        loveNumber.negativeCounts[32 - loop] = 1
                    }
                }
                else { 
                    if (!isNegative) {
                        loveNumber.positiveFlags[32 - loop] = "0"
                        loveNumber.positiveCounts[32 - loop] = 0
                    } else {
                        loveNumber.negativeFlags[32 - loop] = "0"
                        loveNumber.negativeCounts[32 - loop] = 0
                    }
                }
                flag *= 2
            }
            return loveNumber
        }
        static add(number1, number2){
            let loveNumber = new LoveNumber()

            for (let loop = 0; loop < number1.positiveFlags.length; loop++) {
                if ("1" === number1.positiveFlags[loop] || "1" === number2.positiveFlags[loop]) {
                    loveNumber.positiveFlags[loop] = "1"
                    loveNumber.positiveCounts[loop] = number1.positiveCounts[loop] + number2.positiveCounts[loop]
                }
            }
            for (let loop = 0; loop < number1.negativeFlags.length; loop++) {
                if ("1" === number1.negativeFlags[loop] || "1" === number2.negativeFlags[loop]) {
                    loveNumber.negativeFlags[loop] = "1"
                    loveNumber.negativeCounts[loop] = number1.negativeCounts[loop] + number2.negativeCounts[loop]
                }
            }
            for (let loop = 0; loop < number1.positiveFlags.length; loop++) {
                if ("1" === number1.positiveFlags[loop] && "1" === number2.negativeFlags[loop]) {
                    if (0 === number1.positiveCounts[loop] - number2.negativeCounts[loop]) {
                        loveNumber.positiveFlags[loop] = "0"
                        loveNumber.positiveCounts[loop] = 0
                        loveNumber.negativeFlags[loop] = "0"
                        loveNumber.negativeCounts[loop] = 0
                    } else {
                        if (number1.positiveCounts[loop] > number2.positiveCounts[loop]) {
                            loveNumber.positiveFlags[loop] = "1"
                            loveNumber.positiveCounts[loop] = number1.positiveCounts[loop] - number2.positiveCounts[loop]
                            loveNumber.negativeFlags[loop] = "0"
                            loveNumber.negativeCounts[loop] = 0
                        } else {
                            loveNumber.positiveFlags[loop] = "0"
                            loveNumber.positiveCounts[loop] = 0
                            loveNumber.negativeFlags[loop] = "1"
                            loveNumber.negativeCounts[loop] = number2.positiveCounts[loop] - number1.positiveCounts[loop]

                        }
                    }
                }
            }
            return loveNumber
        }
        static subtract(number1, number2){
            let loveNumber = new LoveNumber()
            for (let loop = 0; loop < number1.positiveFlags.length; loop++) {
                if ("1" === number1.positiveFlags[loop] || "1" === number2.positiveFlags[loop]) {
                    loveNumber.positiveFlags[loop] = "1"
                    loveNumber.positiveCounts[loop] = number1.positiveCounts[loop] - number2.positiveCounts[loop]
                    if (0 === loveNumber.positiveCounts[loop]) { loveNumber.positiveFlags[loop] = "0" }
                }
            }
            for (let loop = 0; loop < number1.negativeFlags.length; loop++) {
                if ("1" === number1.negativeFlags[loop] || "1" === number2.negativeFlags[loop]) {
                    loveNumber.negativeFlags[loop] = "1"
                    loveNumber.negativeCounts[loop] = number1.negativeCounts[loop] - number2.negativeCounts[loop]
                    if (0 === loveNumber.negativeCounts[loop]) { loveNumber.negativeFlags[loop] = "0" }
                }
            }
            return loveNumber
        }
        constructor() {
            this.positiveFlags = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
            this.positiveCounts = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
            this.negativeFlags = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
            this.negativeCounts = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
        }
        toDebugString(includeSubscripts) {
            if (!includeSubscripts) {
                let result = "-" + this.negativeFlags.join("")
                result += "+" + this.positiveFlags.join("")
                return result
            }
            let result = ""
            for (let loop = 0; loop < this.negativeFlags.length; loop++) {
                result = result + "-" + this.negativeFlags[loop]
                result = result + "[" + this.negativeCounts[loop] + "]"
                result = result + " "
            }
            for (let loop = 0; loop < this.positiveFlags.length; loop++) {
                result = result + this.positiveFlags[loop]
                result = result + "[" + this.positiveCounts[loop] + "]"
                result = result + " "
            }
            return result
        }
        toHTML(parentNode, includeSubscripts) {
            let negative = ""
            let positive = ""
            let flag = 0x1
            let hasChild = false
            let wrapper = document.createElement("div")

            wrapper.style.display = "flex"
            wrapper.style.flexDirection = "row"
            parentNode.appendChild(wrapper)
            for (let loop = this.negativeFlags.length - 1; loop >= 0; loop--) {
                if ("1" === this.negativeFlags[loop]) { 
                    let node = document.createElement("div")
                    wrapper.appendChild(node)
                    if (hasChild) { node.innerText = "."}
                    node.innerText += "-" + flag
                    if (includeSubscripts) {
                        node = document.createElement("sub")
                        wrapper.appendChild(node)
                        node.innerText = this.negativeCounts[loop]
                    }
                    hasChild = true;
                }
                if ("1" === this.positiveFlags[loop]) { 
                    let node = document.createElement("div")
                    wrapper.appendChild(node)
                    if (hasChild) { node.innerText = "."}
                    node.innerText += flag
                    if (includeSubscripts) { 
                        node = document.createElement("sub")
                        wrapper.appendChild(node)
                        node.innerText = this.positiveCounts[loop]
                    }
                    hasChild = true;
                }
                flag *= 2
            }
            if (!hasChild) {
                let node = document.createElement("div")
                wrapper.appendChild(node)
                node.innerText = "0"
                if (includeSubscripts) { 
                    node = document.createElement("sub")
                    wrapper.appendChild(node)
                    node.innerText = "0" 
                }
            }
        }
        toString(includeSubscripts) {
            let negative = ""
            let positive = ""
            let flag = 0x1

            for (let loop = this.negativeFlags.length - 1; loop >= 0; loop--) {
                if ("1" === this.negativeFlags[loop]) { 
                    negative += "-" + flag + "."
                    if (includeSubscripts) { negative += "[" + this.negativeCounts[loop] + "]"}
                }
                if ("1" === this.positiveFlags[loop]) { 
                    positive += flag + "."
                    if (includeSubscripts) { positive += "[" + this.positiveCounts[loop] + "]"}
                }
                flag *= 2
            }
            if (0 === negative.length && 0 === positive.length) {
                positive = "0"
                if (includeSubscripts) { positive += "[0]" }
            }
            return negative + positive
        }
    }
    
    function test_love_number(number1, number2, number3, number4, number5, number6, includeSubscripts){
        let loveNumber = LoveNumber.convertIntToLoveNumber(number1)
        let loveNumberElement = document.getElementById("LoveNumber1")
        loveNumberElement.innerText = "A) "
        loveNumber.toHTML(loveNumberElement, includeSubscripts)
        loveNumber = LoveNumber.convertIntToLoveNumber(number2)
        loveNumberElement = document.getElementById("LoveNumber2")
        loveNumberElement.innerText = "B) "
        loveNumber.toHTML(loveNumberElement, includeSubscripts)
        loveNumber = LoveNumber.convertIntToLoveNumber(number3)
        loveNumberElement = document.getElementById("LoveNumber3")
        loveNumberElement.innerText = "C) "
        loveNumber.toHTML(loveNumberElement, includeSubscripts)
        loveNumber = LoveNumber.convertIntToLoveNumber(number4)
        loveNumberElement = document.getElementById("LoveNumber4")
        loveNumberElement.innerText = "D) "
        loveNumber.toHTML(loveNumberElement, includeSubscripts)
        loveNumber = LoveNumber.convertIntToLoveNumber(number5)
        loveNumberElement = document.getElementById("LoveNumber5")
        loveNumberElement.innerText = "E) "
        loveNumber.toHTML(loveNumberElement, includeSubscripts)
        loveNumber = LoveNumber.convertIntToLoveNumber(number6)
        loveNumberElement = document.getElementById("LoveNumber6")
        loveNumberElement.innerText = "F) "
        loveNumber.toHTML(loveNumberElement, includeSubscripts)

        loveNumber = LoveNumber.add(LoveNumber.convertIntToLoveNumber(number1), LoveNumber.convertIntToLoveNumber(number2))
        loveNumberElement = document.getElementById("LoveNumber7")
        loveNumberElement.innerText = "A + B) "
        loveNumber.toHTML(loveNumberElement, true)
        loveNumber = LoveNumber.add(LoveNumber.convertIntToLoveNumber(number3), LoveNumber.convertIntToLoveNumber(number4))
        loveNumberElement = document.getElementById("LoveNumber8")
        loveNumberElement.innerText = "C + D) "
        loveNumber.toHTML(loveNumberElement, true)
        loveNumber = LoveNumber.add(LoveNumber.convertIntToLoveNumber(number5), LoveNumber.convertIntToLoveNumber(number6))
        loveNumberElement = document.getElementById("LoveNumber9")
        loveNumberElement.innerText = "E + F) "
        loveNumber.toHTML(loveNumberElement, true)
        loveNumber = LoveNumber.add(LoveNumber.convertIntToLoveNumber(1), LoveNumber.convertIntToLoveNumber(-1))
        loveNumberElement = document.getElementById("LoveNumber10")
        loveNumberElement.innerText = "1 + -1) "
        loveNumber.toHTML(loveNumberElement, true)

        loveNumber = LoveNumber.subtract(LoveNumber.convertIntToLoveNumber(number1), LoveNumber.convertIntToLoveNumber(number2))
        loveNumberElement = document.getElementById("LoveNumber11")
        loveNumberElement.innerText = "A - B) "
        loveNumber.toHTML(loveNumberElement, true)
        loveNumber = LoveNumber.subtract(LoveNumber.convertIntToLoveNumber(number3), LoveNumber.convertIntToLoveNumber(number4))
        loveNumberElement = document.getElementById("LoveNumber12")
        loveNumberElement.innerText = "C - D) "
        loveNumber.toHTML(loveNumberElement, true)
        loveNumber = LoveNumber.subtract(LoveNumber.convertIntToLoveNumber(number5), LoveNumber.convertIntToLoveNumber(number6))
        loveNumberElement = document.getElementById("LoveNumber13")
        loveNumberElement.innerText = "E - F) "
        loveNumber.toHTML(loveNumberElement, true)
        loveNumber = LoveNumber.subtract(LoveNumber.convertIntToLoveNumber(1), LoveNumber.convertIntToLoveNumber(-1))
        loveNumberElement = document.getElementById("LoveNumber14")
        loveNumberElement.innerText = "1 - -1) "
        loveNumber.toHTML(loveNumberElement, true)
    }
</script>
</head>
<body onLoad="test_love_number(1, 2, 3, -1, -2, -3, true);">
    <div>Convert</div>
    <div id="LoveNumber1" style="display: flex; flex-direction: row; margin-right: 5px;"></div>
    <div id="LoveNumber2" style="display: flex; flex-direction: row; margin-right: 5px;"></div>
    <div id="LoveNumber3" style="display: flex; flex-direction: row; margin-right: 5px;"></div>
    <div id="LoveNumber4" style="display: flex; flex-direction: row; margin-right: 5px;"></div>
    <div id="LoveNumber5" style="display: flex; flex-direction: row; margin-right: 5px;"></div>
    <div id="LoveNumber6" style="display: flex; flex-direction: row; margin-right: 5px;"></div>
    <div>Add</div>
    <div id="LoveNumber7" style="display: flex; flex-direction: row; margin-right: 5px;"></div>
    <div id="LoveNumber8" style="display: flex; flex-direction: row; margin-right: 5px;"></div>
    <div id="LoveNumber9" style="display: flex; flex-direction: row; margin-right: 5px;"></div>
    <div id="LoveNumber10" style="display: flex; flex-direction: row; margin-right: 5px;"></div>
    <div>Subtract</div>
    <div id="LoveNumber11" style="display: flex; flex-direction: row; margin-right: 5px;"></div>
    <div id="LoveNumber12" style="display: flex; flex-direction: row; margin-right: 5px;"></div>
    <div id="LoveNumber13" style="display: flex; flex-direction: row; margin-right: 5px;"></div>
    <div id="LoveNumber14" style="display: flex; flex-direction: row; margin-right: 5px;"></div>
</body>
</html>